<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: iOS | Home Of Code Monkey]]></title>
  <link href="http://bbconan.github.io/blog/categories/ios/atom.xml" rel="self"/>
  <link href="http://bbconan.github.io/"/>
  <updated>2013-11-08T15:10:44+08:00</updated>
  <id>http://bbconan.github.io/</id>
  <author>
    <name><![CDATA[conan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[UIDeviceRGBColor CGColor]: message sent to deallocated instance xxx]]></title>
    <link href="http://bbconan.github.io/blog/2013/11/08/uidevicergbcolor-cgcolor-message-sent-to-deallocated-instance-xxx/"/>
    <updated>2013-11-08T14:48:00+08:00</updated>
    <id>http://bbconan.github.io/blog/2013/11/08/uidevicergbcolor-cgcolor-message-sent-to-deallocated-instance-xxx</id>
    <content type="html"><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;近期开发过程中，遇到一个“[UIDeviceRGBColor CGColor]: message sent to deallocated instance xxx”的bug，google了很长时间也没找到原因所在。后来，发现<a href="http://www.91r.net/ask/11318138.html"> 点击此处</a>，这里面所遇到的bug和我的类似。其中，这段话</p>
When setting buttonColor = bc without retaining, buttonColor will become a dangling pointer when the current autorelease pool flushes (assuming it&rsquo;s not retained elsewhere).</p>

<p>[self setNeedsDisplay] will invoke drawRect: later and at that point, buttonColor may already have been deallocated which will crash your app when referring to it.</p>
说明问题所在:当设置完color后，是自动释放的（autorelease）。下次，调用 [self setNeedsDisplay]后，调用drawRect 方法时，里面的color已经被释放了。所以我的解决办法是在设置 self.color = color 后，紧接着
[self.color retain]。</p>

<p>参考地址：<a href="http://www.91r.net/ask/11318138.html">http://www.91r.net/ask/11318138.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[xcode中引入两个静态库冲突'duplicate symbol'的解决方法]]></title>
    <link href="http://bbconan.github.io/blog/2013/09/27/xcodezhong-yin-ru-liang-ge-jing-tai-ku-chong-tu-duplicate-symbol-de-jie-jue-fang-fa/"/>
    <updated>2013-09-27T14:17:00+08:00</updated>
    <id>http://bbconan.github.io/blog/2013/09/27/xcodezhong-yin-ru-liang-ge-jing-tai-ku-chong-tu-duplicate-symbol-de-jie-jue-fang-fa</id>
    <content type="html"><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;在开发过程中，可能需要引入第三方的静态库，有时候会出现duplicate symbol的错误。例如:duplicate symbol <em>OBJC_METACLASS</em>$_Reachability in:/你的xcode路径/DerivedData/iMove-cwhkpttlcvtnivfvakvpiakhvoak/Build/Products/Debug-iphoneos/libPods.a(Reachability.o)<br>/你的项目路径/libVParser.a(Reachability.o)<br>
ld: 208 duplicate symbols for architecture armv7<br>
clang: error: linker command failed with exit code 1 (use -v to see invocation)</p>

<!--more -->


<p>&nbsp;&nbsp;&nbsp;&nbsp;这里有个解决方法：如果静态库结构一样，可以将2个库合并或者将其中1个库中重复的.o文件删除。下面以删除libVParser.a重复的.o文件为例。打开终端。<br></p>

<h5>1、、首先，查看文件结构<br></h5>

<p>输入 lipo -info libVParser.a<br>
结果
Architectures in the fat file: libVParser.a are: armv7 (cputype (12) cpusubtype (11))</p>

<h5>2、将armv7解压出来<br></h5>

<p>输入
lipo libVParser.a -thin armv7 -output libVParser-armv7.a</p>

<h4>3、新建一个文件夹存放解压出来的.o文件 <br></h4>

<p> 输入 mkdir armv7 <br>
 输入 cd armv7</p>

<h5>4、将静态库文件解压 <br></h5>

<p>输入
ar -x ../libVParser-armv7.a</p>

<h5>5、删除重复的.o文件(如果是合并静态库的话，把另一个静态库按同样步骤解压。然后，对比，那些文件可以合并。)</h5>

<h5>6、删除（合并）完后，进行打包。<br></h5>

<p>输入
libtool -static -o ../libnewVPaser.a *.o <br></p>

<p>此时，用新生成的静态库文件就可以正常编译了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[我的代码历史可视化]]></title>
    <link href="http://bbconan.github.io/blog/2013/09/05/wo-de-dai-ma-li-shi-ke-shi-hua/"/>
    <updated>2013-09-05T16:40:00+08:00</updated>
    <id>http://bbconan.github.io/blog/2013/09/05/wo-de-dai-ma-li-shi-ke-shi-hua</id>
    <content type="html"><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最近，我看到一个非常好玩的东西<a href="https://code.google.com/p/gource/">Gource</a>。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gource可以将代码版本控制系统里面的日志全部可视化， 所谓可视化就是可以看见每个成员在系统里面提交代码的行为。 Gource目前支持git/hg/svn，cvs通过一个简单的脚本也可以被Gource支持。
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我将我的项目生成可视化效果截图：<br></p>

<!--more-->


<p><img src="/images/svnHistory.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CocoaHTTPServer出现Crash的解决方法]]></title>
    <link href="http://bbconan.github.io/blog/2013/08/26/cocoahttpserver-crash/"/>
    <updated>2013-08-26T17:33:00+08:00</updated>
    <id>http://bbconan.github.io/blog/2013/08/26/cocoahttpserver-crash</id>
    <content type="html"><![CDATA[<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最近工程中，需要使用httpserver，就用了CocoaHTTPServer。代码的整合非常容易。但是运行后用浏览器连接服务器时，程序会 crash。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最后发现是在 HTTPConnection::filePathForURI 函数中 config 的 documentroot 是空的，调试好久。然后，通过研究和搜索，发现最新版的CocoaHTTPServer用的是ARC。解决办法就是：选择项目 target，Build Phases &ndash;> Compile Sources 中，给所有 CocoaHTTPServer 的代码添加 Compiler Flags ： -fobjc-arc 即可。
<img src="/images/cocoahttpserver_crash.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HMAC_SHA1算法的object-c实现]]></title>
    <link href="http://bbconan.github.io/blog/2013/08/08/hmac-sha1suan-fa-de-object-cshi-xian/"/>
    <updated>2013-08-08T15:26:00+08:00</updated>
    <id>http://bbconan.github.io/blog/2013/08/08/hmac-sha1suan-fa-de-object-cshi-xian</id>
    <content type="html"><![CDATA[<p>做项目时，用到HMAC_SHA1算法。代码实现，如下：
``` objc
static NSString <em>HMAC_SHA1 = @&ldquo;HmacSHA1&rdquo;;
static NSString </em>APPKEY = @&ldquo;123456&rdquo;;//这是key
&ndash; (NSString <em>)generateSignature:(NSString </em>)data
{</p>

<pre><code>const char *cKey = [APPKEY cStringUsingEncoding:NSASCIIStringEncoding];
const char *cData = [data cStringUsingEncoding:NSASCIIStringEncoding];

unsigned char cHMAC[CC_SHA1_DIGEST_LENGTH];

CCHmac(kCCHmacAlgSHA1, cKey, strlen(cKey), cData, strlen(cData), cHMAC);

NSData *HMAC = [[[NSData alloc] initWithBytes:cHMAC length:sizeof(cHMAC)] autorelease];

NSString *hash = [HMAC base64Encoding];

return hash;
</code></pre>

<p>}
```
这里用到NSData类别:<a href="https://github.com/WideTag/WideNoise-iOS/blob/master/WideNoise/Categories/NSData%2BBase64Encoding.m/">https://github.com/WideTag/WideNoise-iOS/blob/master/WideNoise/Categories/NSData%2BBase64Encoding.m/</a></p>
]]></content>
  </entry>
  
</feed>
